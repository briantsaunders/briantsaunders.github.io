<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Working with the Ansible Local Provisioner for Vagrant Boxes | briantsaunders blog</title><meta name=keywords content="vagrant,ansible,frrouting"><meta name=description content="I&rsquo;ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I&rsquo;m using a vagrant box I need to get it in a certain state before it&rsquo;s ready for me to begin using. In the situation of creating lab environments I may need to install FRRouting on the vagrant box and then apply a configuration."><meta name=author content="Me"><link rel=canonical href=https://briantsaunders.github.io/posts/2021/02/working-with-the-ansible-local-provisioner-for-vagrant-boxes/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://briantsaunders.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://briantsaunders.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://briantsaunders.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://briantsaunders.github.io/apple-touch-icon.png><link rel=mask-icon href=https://briantsaunders.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-40258484-2","auto"),ga("send","pageview"))</script><meta property="og:title" content="Working with the Ansible Local Provisioner for Vagrant Boxes"><meta property="og:description" content="I&rsquo;ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I&rsquo;m using a vagrant box I need to get it in a certain state before it&rsquo;s ready for me to begin using. In the situation of creating lab environments I may need to install FRRouting on the vagrant box and then apply a configuration."><meta property="og:type" content="article"><meta property="og:url" content="https://briantsaunders.github.io/posts/2021/02/working-with-the-ansible-local-provisioner-for-vagrant-boxes/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-05T15:47:05-06:00"><meta property="article:modified_time" content="2021-02-05T15:47:05-06:00"><meta property="og:site_name" content="briantsaunders blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Working with the Ansible Local Provisioner for Vagrant Boxes"><meta name=twitter:description content="I&rsquo;ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I&rsquo;m using a vagrant box I need to get it in a certain state before it&rsquo;s ready for me to begin using. In the situation of creating lab environments I may need to install FRRouting on the vagrant box and then apply a configuration."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://briantsaunders.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Working with the Ansible Local Provisioner for Vagrant Boxes","item":"https://briantsaunders.github.io/posts/2021/02/working-with-the-ansible-local-provisioner-for-vagrant-boxes/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Working with the Ansible Local Provisioner for Vagrant Boxes","name":"Working with the Ansible Local Provisioner for Vagrant Boxes","description":"I\u0026rsquo;ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I\u0026rsquo;m using a vagrant box I need to get it in a certain state before it\u0026rsquo;s ready for me to begin using. In the situation of creating lab environments I may need to install FRRouting on the vagrant box and then apply a configuration.","keywords":["vagrant","ansible","frrouting"],"articleBody":"I’ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I’m using a vagrant box I need to get it in a certain state before it’s ready for me to begin using. In the situation of creating lab environments I may need to install FRRouting on the vagrant box and then apply a configuration. A handy feature that vagrant provides to make this possible is the ability to use provisioners that can execute a script prior to the vagrant box being ready for use. The ones I find myself using most are the shell provisioner and ansible local provisioner. In this post I’ll go over how I use the ansible local provisioner to install FRRouting on a Ubuntu 20.04 vagrant box. If you would like to follow along I have created an example located in github here.\nPrerequisites Before you begin you need to do the following:\n Install Vagrant on your workstation Install a Vagrant Provider on your workstation  Review the Vagrantfile Whenever you are working with vagrant boxes you are going to have a Vagrantfile defined. Check out the documentation provided in the previous statement to learn more about Vagrantfiles and everything you can do within one. In this post I won’t go into much detail on the Vagrantfile aside from the provisioner section. The basic gist of a Vagrantfile is it essentially defines your vagrant environment - the virtual boxes, their network connectivity, resources, etc.\nLooking at the Vagrantfile in our example github repo you’ll see that it’s pretty simple.\nVagrant.configure(\"2\") do |config|  config.vm.box = \"bento/ubuntu-20.04\"  config.vm.provision \"ansible_local\" do |ansible|  ansible.playbook = \"playbook.yml\"  ansible.install_mode = \"pip\"  ansible.pip_install_cmd = \"sudo apt install -y python3-distutils \u0026\u0026 curl https://bootstrap.pypa.io/get-pip.py | sudo python3\"  ansible.galaxy_command = \"sudo ansible-galaxy install -r /vagrant/collections/requirements.yml\"  end end The config.vm.box statement defines the vagrant box that we’re going to use (bento/ubuntu-20.04). The next statement goes into our ansible local provisioner. When you perform a vagrant up vagrant will first bring the vagrant box online. Once the vagrant box is online it will run the provisioner. The ansible local provisioner will first install ansible on the vagrant box. There’s a couple methods you can use for the installation. The default method is installing via the operating system package manager. On Ubuntu 20.04 I had issues using that method as focal was not recognized as a valid option. This is the error that I received when attempting that install method:\nE: The repository 'http://ppa.launchpad.net/ansible/ansible/ubuntu focal Release' does not have a Release file. Another approach that vagrant allows is installation via pip. Prior to installing ansible via pip I must first install pip. The vagrant box that I selected comes bare bones and pip is not available. Ubuntu 20.04 does not come with disutils and the pip installation will fail if it’s not present. So I also needed to make sure that is installed prior to the pip installation. Within the Vagrantfile you define how pip should be installed via the pip_install_command statement. In the above example you can see I’m installing python3-disutils first and then installing pip.\nOnce pip is installed vagrant will proceed with installing ansible. If you prefer a specific version of ansible you can define the version otherwise pip will install the latest available. If you have any ansible roles or collections that need to be installed prior to your playbook executing you can define those in the galaxy_command statement. In my example I have a requirements.yml file defined within my collections folder that needs to be installed prior to my playbook executing.\nAfter ansible is installed vagrant will then run the playbook that is defined. In my example my playbook is called playbook.yml. My playbook basically follows the steps outlined here for installing FRRouting. After the installation I also edit the sysctl.conf file to enable routing on the vagrant box. Here are the contents of my playbook:\n--- - name: provision vagrant box with frrouting  hosts: all  gather_facts: no   tasks:   - name: add frr apt-key  ansible.builtin.apt_key:  url: https://deb.frrouting.org/frr/keys.asc  state: present  become: yes   - name: get host distribution  ansible.builtin.command: lsb_release -sc  register: release   - name: add frr repository into source list  ansible.builtin.apt_repository:  repo: \"deb https://deb.frrouting.org/frr {{ release.stdout }} {{ frr_version }}\"  state: present  filename: /etc/apt/sources.list.d/frr  vars:  frr_version: frr-stable  become: yes   - name: install frr  ansible.builtin.apt:  name:  - frr  - frr-pythontools  update_cache: yes  register: apt_status  retries: 100  until: apt_status is success or ('Failed to lock apt for exclusive operation' not in apt_status.msg and '/var/lib/dpkg/lock' not in apt_status.msg)  become: yes   - name: edit sysctl.conf for ipv4 forward  ansible.posix.sysctl:  name: net.ipv4.ip_forward  value: '1'  state: present  reload: yes  become: yes   - name: edit sysctl.conf for ipv6 forward  ansible.posix.sysctl:  name: net.ipv6.conf.all.forwarding  value: '1'  state: present  reload: yes  become: yes Vagrant Up Go ahead and issue a vagrant up within the example repo. You should see output similar to the following.\nBringing machine 'default' up with 'virtualbox' provider... == default: Importing base box 'bento/ubuntu-20.04'... == default: Matching MAC address for NAT networking... == default: Checking if box 'bento/ubuntu-20.04' version '202010.24.0' is up to date... == default: Setting the name of the VM: vagrant-box-ansible-provisioner-example_default_1612559846779_78606 == default: Fixed port collision for 22 = 2222. Now on port 2201. == default: Clearing any previously set network interfaces... == default: Preparing network interfaces based on configuration...  default: Adapter 1: nat == default: Forwarding ports...  default: 22 (guest) = 2201 (host) (adapter 1) == default: Booting VM... == default: Waiting for machine to boot. This may take a few minutes...  default: SSH address: 127.0.0.1:2201  default: SSH username: vagrant  default: SSH auth method: private key  default: Warning: Connection reset. Retrying...  default:  default: Vagrant insecure key detected. Vagrant will automatically replace  default: this with a newly generated keypair for better security.  default:  default: Inserting generated public key within guest...  default: Removing insecure key from the guest if it's present...  default: Key inserted! Disconnecting and reconnecting using new SSH key... == default: Machine booted and ready! == default: Checking for guest additions in VM...  default: The guest additions on this VM do not match the installed version of  default: VirtualBox! In most cases this is fine, but in rare cases it can  default: prevent things such as shared folders from working properly. If you see  default: shared folder errors, please make sure the guest additions within the  default: virtual machine match the version of VirtualBox you have installed on  default: your host and reload your VM.  default:  default: Guest Additions Version: 6.1.16  default: VirtualBox Version: 6.0 == default: Mounting shared folders...  default: /vagrant = /Users/username/directory/vagrant-box-ansible-provisioner-example == default: Running provisioner: ansible_local...  default: Installing Ansible...  default: Installing pip... (for Ansible installation)  default: Running ansible-playbook...  PLAY [provision vagrant box with frrouting] ************************************  TASK [add frr apt-key] ********************************************************* [DEPRECATION WARNING]: Distribution Ubuntu 20.04 on host default should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/ 2.10/reference_appendices/interpreter_discovery.html for more information. This  feature will be removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg. changed: [default]  TASK [get host distribution] *************************************************** changed: [default]  TASK [add frr repository into source list] ************************************* changed: [default]  TASK [install frr] ************************************************************* changed: [default]  TASK [edit sysctl.conf for ipv4 forward] *************************************** changed: [default]  TASK [edit sysctl.conf for ipv6 forward] *************************************** changed: [default]  PLAY RECAP ********************************************************************* default : ok=6 changed=6 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 You now have a vagrant box that has FRRouting installed!\n","wordCount":"1251","inLanguage":"en","datePublished":"2021-02-05T15:47:05-06:00","dateModified":"2021-02-05T15:47:05-06:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://briantsaunders.github.io/posts/2021/02/working-with-the-ansible-local-provisioner-for-vagrant-boxes/"},"publisher":{"@type":"Organization","name":"briantsaunders blog","logo":{"@type":"ImageObject","url":"https://briantsaunders.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://briantsaunders.github.io/ accesskey=h title="briantsaunders blog (Alt + H)">briantsaunders blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://briantsaunders.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://briantsaunders.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://briantsaunders.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://briantsaunders.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://briantsaunders.github.io/posts/>Posts</a></div><h1 class=post-title>Working with the Ansible Local Provisioner for Vagrant Boxes</h1><div class=post-meta><span title="2021-02-05 15:47:05 -0600 -0600">February 5, 2021</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#prerequisites aria-label=Prerequisites>Prerequisites</a></li><li><a href=#review-the-vagrantfile aria-label="Review the Vagrantfile">Review the Vagrantfile</a></li><li><a href=#vagrant-up aria-label="Vagrant Up">Vagrant Up</a></li></ul></div></details></div><div class=post-content><p>I&rsquo;ve been working with vagrant boxes for quite awhile now. I usually use them for development environments or creating lab environments for testing various network functions (i.e. BGP EVPN). Often times when I&rsquo;m using a vagrant box I need to get it in a certain state before it&rsquo;s ready for me to begin using. In the situation of creating lab environments I may need to install <a href=https://frrouting.org/>FRRouting</a> on the vagrant box and then apply a configuration. A handy feature that vagrant provides to make this possible is the ability to use <a href=https://www.vagrantup.com/docs/provisioning>provisioners</a> that can execute a script prior to the vagrant box being ready for use. The ones I find myself using most are the <a href=https://www.vagrantup.com/docs/provisioning/shell>shell provisioner</a> and <a href=https://www.vagrantup.com/docs/provisioning/ansible_local>ansible local provisioner</a>. In this post I&rsquo;ll go over how I use the ansible local provisioner to install FRRouting on a Ubuntu 20.04 vagrant box. If you would like to follow along I have created an example located in github <a href=https://github.com/briantsaunders/vagrant-box-ansible-provisioner-example>here</a>.</p><h3 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h3><p>Before you begin you need to do the following:</p><ul><li>Install <a href=https://www.vagrantup.com/downloads>Vagrant</a> on your workstation</li><li>Install a <a href=https://www.vagrantup.com/docs/providers>Vagrant Provider</a> on your workstation</li></ul><h3 id=review-the-vagrantfile>Review the Vagrantfile<a hidden class=anchor aria-hidden=true href=#review-the-vagrantfile>#</a></h3><p>Whenever you are working with vagrant boxes you are going to have a <a href=https://www.vagrantup.com/docs/vagrantfile>Vagrantfile</a> defined. Check out the documentation provided in the previous statement to learn more about Vagrantfiles and everything you can do within one. In this post I won&rsquo;t go into much detail on the Vagrantfile aside from the provisioner section. The basic gist of a Vagrantfile is it essentially defines your vagrant environment - the virtual boxes, their network connectivity, resources, etc.</p><p>Looking at the Vagrantfile in our example github repo you&rsquo;ll see that it&rsquo;s pretty simple.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>Vagrant</span><span style=color:#f92672>.</span>configure(<span style=color:#e6db74>&#34;2&#34;</span>) <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>config<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>box <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bento/ubuntu-20.04&#34;</span>
</span></span><span style=display:flex><span>  config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>provision <span style=color:#e6db74>&#34;ansible_local&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>ansible<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    ansible<span style=color:#f92672>.</span>playbook <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;playbook.yml&#34;</span>
</span></span><span style=display:flex><span>    ansible<span style=color:#f92672>.</span>install_mode <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;pip&#34;</span>
</span></span><span style=display:flex><span>    ansible<span style=color:#f92672>.</span>pip_install_cmd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sudo apt install -y python3-distutils &amp;&amp; curl https://bootstrap.pypa.io/get-pip.py | sudo python3&#34;</span>
</span></span><span style=display:flex><span>    ansible<span style=color:#f92672>.</span>galaxy_command <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sudo ansible-galaxy install -r /vagrant/collections/requirements.yml&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p>The <code>config.vm.box</code> statement defines the vagrant box that we&rsquo;re going to use (bento/ubuntu-20.04). The next statement goes into our ansible local provisioner. When you perform a <code>vagrant up</code> vagrant will first bring the vagrant box online. Once the vagrant box is online it will run the provisioner. The ansible local provisioner will first install ansible on the vagrant box. There&rsquo;s a couple methods you can use for the installation. The default method is installing via the operating system package manager. On Ubuntu 20.04 I had issues using that method as focal was not recognized as a valid option. This is the error that I received when attempting that install method:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>E: The repository <span style=color:#e6db74>&#39;http://ppa.launchpad.net/ansible/ansible/ubuntu focal Release&#39;</span> does not have a Release file.
</span></span></code></pre></div><p>Another approach that vagrant allows is installation via pip. Prior to installing ansible via pip I must first install pip. The vagrant box that I selected comes bare bones and pip is not available. Ubuntu 20.04 does not come with disutils and the pip installation will fail if it&rsquo;s not present. So I also needed to make sure that is installed prior to the pip installation. Within the Vagrantfile you define how pip should be installed via the <code>pip_install_command</code> statement. In the above example you can see I&rsquo;m installing <code>python3-disutils</code> first and then installing pip.</p><p>Once pip is installed vagrant will proceed with installing ansible. If you prefer a specific version of ansible you can define the <code>version</code> otherwise pip will install the latest available. If you have any ansible roles or collections that need to be installed prior to your playbook executing you can define those in the <code>galaxy_command</code> statement. In my example I have a requirements.yml file defined within my collections folder that needs to be installed prior to my playbook executing.</p><p>After ansible is installed vagrant will then run the playbook that is defined. In my example my playbook is called <code>playbook.yml</code>. My playbook basically follows the steps outlined <a href=https://deb.frrouting.org/>here</a> for installing FRRouting. After the installation I also edit the <code>sysctl.conf</code> file to enable routing on the vagrant box. Here are the contents of my playbook:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>provision vagrant box with frrouting</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>: <span style=color:#ae81ff>all</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>gather_facts</span>: <span style=color:#66d9ef>no</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tasks</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>add frr apt-key</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.apt_key</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://deb.frrouting.org/frr/keys.asc</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>become</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>get host distribution</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.command</span>: <span style=color:#ae81ff>lsb_release -sc</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>register</span>: <span style=color:#ae81ff>release</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>add frr repository into source list</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.apt_repository</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>repo</span>: <span style=color:#e6db74>&#34;deb https://deb.frrouting.org/frr {{ release.stdout }} {{ frr_version }}&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>filename</span>: <span style=color:#ae81ff>/etc/apt/sources.list.d/frr</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>vars</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>frr_version</span>: <span style=color:#ae81ff>frr-stable</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>become</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>install frr</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.apt</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>frr</span>
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>frr-pythontools</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>update_cache</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>register</span>: <span style=color:#ae81ff>apt_status</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>retries</span>: <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>until</span>: <span style=color:#ae81ff>apt_status is success or (&#39;Failed to lock apt for exclusive operation&#39; not in apt_status.msg and &#39;/var/lib/dpkg/lock&#39; not in apt_status.msg)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>become</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>edit sysctl.conf for ipv4 forward</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.posix.sysctl</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>net.ipv4.ip_forward</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#39;1&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>reload</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>become</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>edit sysctl.conf for ipv6 forward</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.posix.sysctl</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>net.ipv6.conf.all.forwarding</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#39;1&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>reload</span>: <span style=color:#66d9ef>yes</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>become</span>: <span style=color:#66d9ef>yes</span>
</span></span></code></pre></div><h3 id=vagrant-up>Vagrant Up<a hidden class=anchor aria-hidden=true href=#vagrant-up>#</a></h3><p>Go ahead and issue a <code>vagrant up</code> within the example repo. You should see output similar to the following.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Bringing machine <span style=color:#e6db74>&#39;default&#39;</span> up with <span style=color:#e6db74>&#39;virtualbox&#39;</span> provider...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Importing base box <span style=color:#e6db74>&#39;bento/ubuntu-20.04&#39;</span>...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Matching MAC address <span style=color:#66d9ef>for</span> NAT networking...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Checking <span style=color:#66d9ef>if</span> box <span style=color:#e6db74>&#39;bento/ubuntu-20.04&#39;</span> version <span style=color:#e6db74>&#39;202010.24.0&#39;</span> is up to date...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Setting the name of the VM: vagrant-box-ansible-provisioner-example_default_1612559846779_78606
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Fixed port collision <span style=color:#66d9ef>for</span> 22 <span style=color:#f92672>=</span>&gt; 2222. Now on port 2201.
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Clearing any previously set network interfaces...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Preparing network interfaces based on configuration...
</span></span><span style=display:flex><span>    default: Adapter 1: nat
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Forwarding ports...
</span></span><span style=display:flex><span>    default: <span style=color:#ae81ff>22</span> <span style=color:#f92672>(</span>guest<span style=color:#f92672>)</span> <span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>2201</span> <span style=color:#f92672>(</span>host<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>adapter 1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Booting VM...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Waiting <span style=color:#66d9ef>for</span> machine to boot. This may take a few minutes...
</span></span><span style=display:flex><span>    default: SSH address: 127.0.0.1:2201
</span></span><span style=display:flex><span>    default: SSH username: vagrant
</span></span><span style=display:flex><span>    default: SSH auth method: private key
</span></span><span style=display:flex><span>    default: Warning: Connection reset. Retrying...
</span></span><span style=display:flex><span>    default:
</span></span><span style=display:flex><span>    default: Vagrant insecure key detected. Vagrant will automatically replace
</span></span><span style=display:flex><span>    default: this with a newly generated keypair <span style=color:#66d9ef>for</span> better security.
</span></span><span style=display:flex><span>    default:
</span></span><span style=display:flex><span>    default: Inserting generated public key within guest...
</span></span><span style=display:flex><span>    default: Removing insecure key from the guest <span style=color:#66d9ef>if</span> it<span style=color:#960050;background-color:#1e0010>&#39;</span>s present...
</span></span><span style=display:flex><span>    default: Key inserted! Disconnecting and reconnecting using new SSH key...
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Machine booted and ready!
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Checking <span style=color:#66d9ef>for</span> guest additions in VM...
</span></span><span style=display:flex><span>    default: The guest additions on this VM <span style=color:#66d9ef>do</span> not match the installed version of
</span></span><span style=display:flex><span>    default: VirtualBox! In most cases this is fine, but in rare cases it can
</span></span><span style=display:flex><span>    default: prevent things such as shared folders from working properly. If you see
</span></span><span style=display:flex><span>    default: shared folder errors, please make sure the guest additions within the
</span></span><span style=display:flex><span>    default: virtual machine match the version of VirtualBox you have installed on
</span></span><span style=display:flex><span>    default: your host and reload your VM.
</span></span><span style=display:flex><span>    default:
</span></span><span style=display:flex><span>    default: Guest Additions Version: 6.1.16
</span></span><span style=display:flex><span>    default: VirtualBox Version: 6.0
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Mounting shared folders...
</span></span><span style=display:flex><span>    default: /vagrant <span style=color:#f92672>=</span>&gt; /Users/username/directory/vagrant-box-ansible-provisioner-example
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; default: Running provisioner: ansible_local...
</span></span><span style=display:flex><span>    default: Installing Ansible...
</span></span><span style=display:flex><span>    default: Installing pip... <span style=color:#f92672>(</span><span style=color:#66d9ef>for</span> Ansible installation<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    default: Running ansible-playbook...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>provision vagrant box with frrouting<span style=color:#f92672>]</span> ************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>add frr apt-key<span style=color:#f92672>]</span> *********************************************************
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>DEPRECATION WARNING<span style=color:#f92672>]</span>: Distribution Ubuntu 20.04 on host default should use
</span></span><span style=display:flex><span>/usr/bin/python3, but is using /usr/bin/python <span style=color:#66d9ef>for</span> backward compatibility with
</span></span><span style=display:flex><span>prior Ansible releases. A future Ansible release will default to using the
</span></span><span style=display:flex><span>discovered platform python <span style=color:#66d9ef>for</span> this host. See https://docs.ansible.com/ansible/
</span></span><span style=display:flex><span>2.10/reference_appendices/interpreter_discovery.html <span style=color:#66d9ef>for</span> more information. This
</span></span><span style=display:flex><span> feature will be removed in version 2.12. Deprecation warnings can be disabled
</span></span><span style=display:flex><span>by setting deprecation_warnings<span style=color:#f92672>=</span>False in ansible.cfg.
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>get host distribution<span style=color:#f92672>]</span> ***************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>add frr repository into source list<span style=color:#f92672>]</span> *************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>install frr<span style=color:#f92672>]</span> *************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>edit sysctl.conf <span style=color:#66d9ef>for</span> ipv4 forward<span style=color:#f92672>]</span> ***************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>edit sysctl.conf <span style=color:#66d9ef>for</span> ipv6 forward<span style=color:#f92672>]</span> ***************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************
</span></span><span style=display:flex><span>default                    : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>You now have a vagrant box that has FRRouting installed!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://briantsaunders.github.io/tags/vagrant/>vagrant</a></li><li><a href=https://briantsaunders.github.io/tags/ansible/>ansible</a></li><li><a href=https://briantsaunders.github.io/tags/frrouting/>frrouting</a></li></ul><nav class=paginav><a class=next href=https://briantsaunders.github.io/posts/2019/08/my-flask-api-setup/><span class=title>Next »</span><br><span>My Flask API Setup</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on twitter" href="https://twitter.com/intent/tweet/?text=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes&url=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f&hashtags=vagrant%2cansible%2cfrrouting"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f&title=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes&summary=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes&source=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f&title=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on whatsapp" href="https://api.whatsapp.com/send?text=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes%20-%20https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Working with the Ansible Local Provisioner for Vagrant Boxes on telegram" href="https://telegram.me/share/url?text=Working%20with%20the%20Ansible%20Local%20Provisioner%20for%20Vagrant%20Boxes&url=https%3a%2f%2fbriantsaunders.github.io%2fposts%2f2021%2f02%2fworking-with-the-ansible-local-provisioner-for-vagrant-boxes%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://briantsaunders.github.io/>briantsaunders blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>